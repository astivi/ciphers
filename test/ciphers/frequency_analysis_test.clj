(ns ciphers.frequency-analysis-test
  (:require [ciphers.frequency-analysis :as frequency-analysis]
            [midje.sweet :refer :all]))


(fact "Frequencies correctly calculate the frequency of each letter in a string"
      (frequency-analysis/frequencies "radyjgtxhpsncpbxrvtctgpaejgedhtegdvgpbbxcvapcvjpvtrdbqxcxcviwtpeegdprwpqxaxinpcsxcitgprixktstktadebtciduphrgxeixcvapcvjpvtlxiwpctuuxrxtcipcsgdqjhixcugphigjrijgtudgbjaixiwgtpstsegdvgpbbxcvo") => {\a 7, \b 8, \c 16, \d 10, \e 8, \f 0, \g 16, \h 5, \i 13, \j 8, \k 2, \l 1, \m 0, \n 2, \o 1, \p 19, \q 3, \r 8, \s 6, \t 17, \u 5, \v 11, \w 4, \x 17, \y 1, \z 0})

(fact "Ordered frequencies returns the frequency of each letter in a string ordered by occurences"
      (frequency-analysis/ordered-frequencies "radyjgtxhpsncpbxrvtctgpaejgedhtegdvgpbbxcvapcvjpvtrdbqxcxcviwtpeegdprwpqxaxinpcsxcitgprixktstktadebtciduphrgxeixcvapcvjpvtlxiwpctuuxrxtcipcsgdqjhixcugphigjrijgtudgbjaixiwgtpstsegdvgpbbxcvo") => '([\p 19] [\t 17] [\x 17] [\c 16] [\g 16] [\i 13] [\v 11] [\d 10] [\b 8] [\e 8] [\j 8] [\r 8] [\a 7] [\s 6] [\h 5] [\u 5] [\w 4] [\q 3] [\k 2] [\n 2] [\l 1] [\o 1] [\y 1] [\f 0] [\m 0] [\z 0]))

(fact "Top letters returns the top 3 letters with more occurences in a string"
      (frequency-analysis/top-three "radyjgtxhpsncpbxrvtctgpaejgedhtegdvgpbbxcvapcvjpvtrdbqxcxcviwtpeegdprwpqxaxinpcsxcitgprixktstktadebtciduphrgxeixcvapcvjpvtlxiwpctuuxrxtcipcsgdqjhixcugphigjrijgtudgbjaixiwgtpstsegdvgpbbxcvo") => '([\p 19] [\t 17] [\x 17])
      (frequency-analysis/top-three "ahixblmaxmabgzpbmayxtmaxklmatmixkvaxlbgmaxlhnetgwlbgzlmaxmngxpbmahnmmaxphkwltgwgxoxklmhiltmtee") => '([\m 14] [\x 12] [\a 11]))

(fact "Sub-frequency gets the frequency for characters in a string, every n characters"
      (frequency-analysis/subfrequency "ymajsdgbdjpflcglfiklvl" 5) => '([\d "0.20"] [\l "0.20"] [\p "0.20"] [\v "0.20"] [\y "0.20"] [\a "0.00"] [\b "0.00"] [\c "0.00"] [\e "0.00"] [\f "0.00"] [\g "0.00"] [\h "0.00"] [\i "0.00"] [\j "0.00"] [\k "0.00"] [\m "0.00"] [\n "0.00"] [\o "0.00"] [\q "0.00"] [\r "0.00"] [\s "0.00"] [\t "0.00"] [\u "0.00"] [\w "0.00"] [\x "0.00"] [\z "0.00"]))

(fact "Calculate all rotations of subfrequencies"
      (frequency-analysis/all-subfrequencies "ymajsdgbdjpflcglfiklvl" 5) =>
      ['([\d "0.20"] [\l "0.20"] [\p "0.20"] [\v "0.20"] [\y "0.20"] [\a "0.00"] [\b "0.00"] [\c "0.00"] [\e "0.00"] [\f "0.00"] [\g "0.00"] [\h "0.00"] [\i "0.00"] [\j "0.00"] [\k "0.00"] [\m "0.00"] [\n "0.00"] [\o "0.00"] [\q "0.00"] [\r "0.00"] [\s "0.00"] [\t "0.00"] [\u "0.00"] [\w "0.00"] [\x "0.00"] [\z "0.00"])
       '([\f "0.40"] [\g "0.20"] [\l "0.20"] [\m "0.20"] [\a "0.00"] [\b "0.00"] [\c "0.00"] [\d "0.00"] [\e "0.00"] [\h "0.00"] [\i "0.00"] [\j "0.00"] [\k "0.00"] [\n "0.00"] [\o "0.00"] [\p "0.00"] [\q "0.00"] [\r "0.00"] [\s "0.00"] [\t "0.00"] [\u "0.00"] [\v "0.00"] [\w "0.00"] [\x "0.00"] [\y "0.00"] [\z "0.00"])
       '([\a "0.25"] [\b "0.25"] [\i "0.25"] [\l "0.25"] [\c "0.00"] [\d "0.00"] [\e "0.00"] [\f "0.00"] [\g "0.00"] [\h "0.00"] [\j "0.00"] [\k "0.00"] [\m "0.00"] [\n "0.00"] [\o "0.00"] [\p "0.00"] [\q "0.00"] [\r "0.00"] [\s "0.00"] [\t "0.00"] [\u "0.00"] [\v "0.00"] [\w "0.00"] [\x "0.00"] [\y "0.00"] [\z "0.00"])
       '([\c "0.25"] [\d "0.25"] [\j "0.25"] [\k "0.25"] [\a "0.00"] [\b "0.00"] [\e "0.00"] [\f "0.00"] [\g "0.00"] [\h "0.00"] [\i "0.00"] [\l "0.00"] [\m "0.00"] [\n "0.00"] [\o "0.00"] [\p "0.00"] [\q "0.00"] [\r "0.00"] [\s "0.00"] [\t "0.00"] [\u "0.00"] [\v "0.00"] [\w "0.00"] [\x "0.00"] [\y "0.00"] [\z "0.00"])
       '([\g "0.25"] [\j "0.25"] [\l "0.25"] [\s "0.25"] [\a "0.00"] [\b "0.00"] [\c "0.00"] [\d "0.00"] [\e "0.00"] [\f "0.00"] [\h "0.00"] [\i "0.00"] [\k "0.00"] [\m "0.00"] [\n "0.00"] [\o "0.00"] [\p "0.00"] [\q "0.00"] [\r "0.00"] [\t "0.00"] [\u "0.00"] [\v "0.00"] [\w "0.00"] [\x "0.00"] [\y "0.00"] [\z "0.00"])]
      (frequency-analysis/all-subfrequencies "rzsrppgeamjllagcpwxismxxcalecwygluetcaguepwwlznpclepcsgcpkgbacltcifstvntybwsepwutzkinweettwgqwjpnweefbwgazgvciebtvyalvyjlowhsmhdacdpcqrtobzttlwpznepnpacpqfspxwcomfiazgvciebtvyalvyjlowhhparstwsewlwplwkptgexmfiznudmwddymguepwutzkisqywwmntwxjdrzsbxqfvwifvfiytdwoxyoldsmjpnkgbatahsuwceascopwgyinpwzscvazthikhzuwituwhcmxtczwsewshlusotvyvciutepwjdvskjijapqywmcjzpkdpdayjtlwsxqkhttwspalgzgwgfakwzxhtceshyietonggsmjhsmopdxghepmbzckajiopclwsepwecmkxomfitidbplsaznxgpmvdxjqecmkxomfimijpnsgqlus" 2) =>
      ['([\w "0.11"] [\s "0.07"] [\e "0.07"] [\c "0.07"] [\y "0.06"] [\l "0.06"] [\g "0.05"] [\p "0.05"] [\t "0.05"] [\f "0.05"] [\j "0.04"] [\a "0.04"] [\n "0.04"] [\o "0.04"] [\z "0.04"] [\d "0.03"] [\k "0.03"] [\x "0.03"] [\h "0.02"] [\m "0.02"] [\r "0.01"] [\q "0.01"] [\u "0.01"] [\v "0.01"] [\b "0.00"] [\i "0.00"])
       '([\p "0.09"] [\i "0.09"] [\t "0.07"] [\m "0.07"] [\w "0.06"] [\a "0.05"] [\v "0.05"] [\c "0.05"] [\b "0.04"] [\h "0.04"] [\s "0.04"] [\u "0.04"] [\z "0.04"] [\g "0.04"] [\e "0.03"] [\x "0.03"] [\l "0.03"] [\q "0.03"] [\d "0.02"] [\j "0.02"] [\k "0.02"] [\n "0.02"] [\o "0.02"] [\r "0.01"] [\f "0.00"] [\y "0.00"])]
      (frequency-analysis/all-subfrequencies "rzsrppgeamjllagcpwxismxxcalecwygluetcaguepwwlznpclepcsgcpkgbacltcifstvntybwsepwutzkinweettwgqwjpnweefbwgazgvciebtvyalvyjlowhsmhdacdpcqrtobzttlwpznepnpacpqfspxwcomfiazgvciebtvyalvyjlowhhparstwsewlwplwkptgexmfiznudmwddymguepwutzkisqywwmntwxjdrzsbxqfvwifvfiytdwoxyoldsmjpnkgbatahsuwceascopwgyinpwzscvazthikhzuwituwhcmxtczwsewshlusotvyvciutepwjdvskjijapqywmcjzpkdpdayjtlwsxqkhttwspalgzgwgfakwzxhtceshyietonggsmjhsmopdxghepmbzckajiopclwsepwecmkxomfitidbplsaznxgpmvdxjqecmkxomfimijpnsgqlus" 3) =>
      ['([\w "0.10"] [\c "0.07"] [\s "0.07"] [\p "0.06"] [\t "0.06"] [\e "0.05"] [\l "0.05"] [\y "0.05"] [\z "0.05"] [\g "0.04"] [\h "0.04"] [\a "0.03"] [\f "0.03"] [\i "0.03"] [\m "0.03"] [\o "0.03"] [\u "0.03"] [\b "0.02"] [\j "0.02"] [\n "0.02"] [\k "0.02"] [\q "0.02"] [\r "0.02"] [\v "0.02"] [\x "0.02"] [\d "0.01"])
       '([\w "0.07"] [\c "0.07"] [\g "0.06"] [\i "0.06"] [\m "0.06"] [\a "0.06"] [\p "0.06"] [\t "0.06"] [\d "0.05"] [\e "0.04"] [\x "0.04"] [\z "0.04"] [\j "0.04"] [\k "0.04"] [\s "0.04"] [\u "0.04"] [\n "0.03"] [\o "0.03"] [\f "0.02"] [\q "0.02"] [\b "0.01"] [\h "0.01"] [\l "0.01"] [\v "0.01"] [\y "0.01"] [\r "0.01"])
       '([\p "0.09"] [\w "0.08"] [\l "0.07"] [\s "0.07"] [\e "0.06"] [\t "0.06"] [\v "0.06"] [\a "0.05"] [\g "0.04"] [\h "0.04"] [\i "0.04"] [\x "0.04"] [\c "0.03"] [\j "0.03"] [\m "0.03"] [\y "0.03"] [\b "0.02"] [\d "0.02"] [\k "0.02"] [\n "0.02"] [\z "0.02"] [\o "0.02"] [\q "0.02"] [\f "0.01"] [\r "0.01"] [\u "0.01"])]
      (frequency-analysis/all-subfrequencies "rzsrppgeamjllagcpwxismxxcalecwygluetcaguepwwlznpclepcsgcpkgbacltcifstvntybwsepwutzkinweettwgqwjpnweefbwgazgvciebtvyalvyjlowhsmhdacdpcqrtobzttlwpznepnpacpqfspxwcomfiazgvciebtvyalvyjlowhhparstwsewlwplwkptgexmfiznudmwddymguepwutzkisqywwmntwxjdrzsbxqfvwifvfiytdwoxyoldsmjpnkgbatahsuwceascopwgyinpwzscvazthikhzuwituwhcmxtczwsewshlusotvyvciutepwjdvskjijapqywmcjzpkdpdayjtlwsxqkhttwspalgzgwgfakwzxhtceshyietonggsmjhsmopdxghepmbzckajiopclwsepwecmkxomfitidbplsaznxgpmvdxjqecmkxomfimijpnsgqlus" 4) =>
      ['([\c "0.13"] [\p "0.10"] [\t "0.10"] [\e "0.07"] [\l "0.07"] [\s "0.07"] [\z "0.06"] [\a "0.05"] [\o "0.05"] [\n "0.04"] [\y "0.04"] [\d "0.03"] [\w "0.03"] [\x "0.03"] [\f "0.02"] [\m "0.02"] [\h "0.02"] [\j "0.02"] [\r "0.02"] [\q "0.01"] [\v "0.01"] [\b "0.00"] [\g "0.00"] [\i "0.00"] [\k "0.00"] [\u "0.00"])
       '([\m "0.13"] [\i "0.11"] [\p "0.08"] [\w "0.07"] [\z "0.07"] [\a "0.07"] [\v "0.06"] [\l "0.05"] [\q "0.05"] [\u "0.05"] [\t "0.04"] [\c "0.03"] [\n "0.03"] [\x "0.03"] [\b "0.02"] [\k "0.02"] [\o "0.02"] [\s "0.02"] [\e "0.01"] [\g "0.01"] [\j "0.01"] [\d "0.00"] [\f "0.00"] [\h "0.00"] [\r "0.00"] [\y "0.00"])
       '([\w "0.19"] [\g "0.11"] [\s "0.08"] [\y "0.08"] [\e "0.07"] [\f "0.07"] [\j "0.07"] [\k "0.07"] [\l "0.04"] [\d "0.03"] [\n "0.03"] [\x "0.03"] [\a "0.02"] [\o "0.02"] [\h "0.02"] [\u "0.02"] [\z "0.02"] [\m "0.01"] [\q "0.01"] [\r "0.01"] [\v "0.01"] [\b "0.00"] [\c "0.00"] [\i "0.00"] [\p "0.00"] [\t "0.00"])
       '([\p "0.10"] [\t "0.10"] [\h "0.08"] [\g "0.07"] [\i "0.07"] [\s "0.07"] [\b "0.06"] [\c "0.06"] [\e "0.06"] [\d "0.05"] [\a "0.04"] [\v "0.04"] [\w "0.04"] [\j "0.03"] [\u "0.03"] [\x "0.03"] [\k "0.02"] [\r "0.02"] [\l "0.01"] [\o "0.01"] [\q "0.01"] [\z "0.01"] [\f "0.00"] [\m "0.00"] [\n "0.00"] [\y "0.00"])]
      (frequency-analysis/all-subfrequencies "rzsrppgeamjllagcpwxismxxcalecwygluetcaguepwwlznpclepcsgcpkgbacltcifstvntybwsepwutzkinweettwgqwjpnweefbwgazgvciebtvyalvyjlowhsmhdacdpcqrtobzttlwpznepnpacpqfspxwcomfiazgvciebtvyalvyjlowhhparstwsewlwplwkptgexmfiznudmwddymguepwutzkisqywwmntwxjdrzsbxqfvwifvfiytdwoxyoldsmjpnkgbatahsuwceascopwgyinpwzscvazthikhzuwituwhcmxtczwsewshlusotvyvciutepwjdvskjijapqywmcjzpkdpdayjtlwsxqkhttwspalgzgwgfakwzxhtceshyietonggsmjhsmopdxghepmbzckajiopclwsepwecmkxomfitidbplsaznxgpmvdxjqecmkxomfimijpnsgqlus" 5) =>
      ['([\e "0.08"] [\t "0.08"] [\z "0.07"] [\a "0.06"] [\p "0.06"] [\w "0.06"] [\h "0.05"] [\m "0.05"] [\s "0.05"] [\y "0.05"] [\d "0.04"] [\i "0.04"] [\l "0.04"] [\o "0.04"] [\c "0.03"] [\f "0.03"] [\n "0.03"] [\u "0.03"] [\g "0.02"] [\r "0.02"] [\j "0.01"] [\k "0.01"] [\q "0.01"] [\x "0.01"] [\b "0.00"] [\v "0.00"])
       '([\p "0.13"] [\w "0.07"] [\c "0.06"] [\g "0.06"] [\e "0.05"] [\l "0.05"] [\o "0.05"] [\a "0.04"] [\b "0.04"] [\j "0.04"] [\n "0.04"] [\s "0.04"] [\v "0.04"] [\d "0.03"] [\f "0.03"] [\h "0.03"] [\k "0.03"] [\m "0.03"] [\t "0.03"] [\z "0.03"] [\i "0.02"] [\y "0.02"] [\u "0.01"] [\q "0.00"] [\r "0.00"] [\x "0.00"])
       '([\w "0.13"] [\s "0.09"] [\p "0.08"] [\m "0.06"] [\a "0.05"] [\c "0.05"] [\e "0.05"] [\k "0.05"] [\l "0.05"] [\v "0.05"] [\i "0.04"] [\x "0.04"] [\f "0.03"] [\g "0.03"] [\t "0.03"] [\b "0.02"] [\d "0.02"] [\q "0.02"] [\y "0.02"] [\z "0.02"] [\h "0.01"] [\o "0.01"] [\r "0.01"] [\u "0.01"] [\j "0.00"] [\n "0.00"])
       '([\w "0.11"] [\c "0.07"] [\g "0.07"] [\t "0.07"] [\i "0.06"] [\e "0.05"] [\z "0.05"] [\a "0.04"] [\h "0.04"] [\p "0.04"] [\s "0.04"] [\x "0.04"] [\m "0.03"] [\n "0.03"] [\v "0.03"] [\y "0.03"] [\b "0.02"] [\d "0.02"] [\j "0.02"] [\k "0.02"] [\o "0.02"] [\q "0.02"] [\u "0.02"] [\l "0.01"] [\r "0.01"] [\f "0.00"])
       '([\j "0.08"] [\t "0.08"] [\x "0.07"] [\c "0.06"] [\l "0.06"] [\s "0.06"] [\i "0.05"] [\u "0.05"] [\g "0.04"] [\q "0.04"] [\w "0.04"] [\a "0.03"] [\d "0.03"] [\m "0.03"] [\n "0.03"] [\p "0.03"] [\y "0.03"] [\b "0.02"] [\e "0.02"] [\f "0.02"] [\k "0.02"] [\v "0.02"] [\z "0.02"] [\h "0.01"] [\o "0.01"] [\r "0.01"])]
      (frequency-analysis/all-subfrequencies "rzsrppgeamjllagcpwxismxxcalecwygluetcaguepwwlznpclepcsgcpkgbacltcifstvntybwsepwutzkinweettwgqwjpnweefbwgazgvciebtvyalvyjlowhsmhdacdpcqrtobzttlwpznepnpacpqfspxwcomfiazgvciebtvyalvyjlowhhparstwsewlwplwkptgexmfiznudmwddymguepwutzkisqywwmntwxjdrzsbxqfvwifvfiytdwoxyoldsmjpnkgbatahsuwceascopwgyinpwzscvazthikhzuwituwhcmxtczwsewshlusotvyvciutepwjdvskjijapqywmcjzpkdpdayjtlwsxqkhttwspalgzgwgfakwzxhtceshyietonggsmjhsmopdxghepmbzckajiopclwsepwecmkxomfitidbplsaznxgpmvdxjqecmkxomfimijpnsgqlus" 6) =>
      ['([\w "0.11"] [\s "0.10"] [\y "0.10"] [\c "0.09"] [\l "0.07"] [\f "0.06"] [\g "0.06"] [\a "0.04"] [\e "0.04"] [\h "0.04"] [\n "0.04"] [\o "0.04"] [\p "0.04"] [\z "0.04"] [\j "0.02"] [\r "0.02"] [\t "0.02"] [\x "0.02"] [\d "0.01"] [\k "0.01"] [\q "0.01"] [\u "0.01"] [\b "0.00"] [\i "0.00"] [\m "0.00"] [\v "0.00"])
       '([\i "0.12"] [\a "0.10"] [\m "0.09"] [\c "0.07"] [\g "0.06"] [\u "0.06"] [\p "0.05"] [\t "0.05"] [\w "0.05"] [\q "0.04"] [\s "0.04"] [\x "0.04"] [\z "0.04"] [\b "0.02"] [\d "0.02"] [\e "0.02"] [\k "0.02"] [\o "0.02"] [\v "0.02"] [\h "0.01"] [\l "0.01"] [\n "0.01"] [\r "0.01"] [\f "0.00"] [\j "0.00"] [\y "0.00"])
       '([\w "0.12"] [\e "0.11"] [\l "0.09"] [\s "0.09"] [\a "0.06"] [\t "0.06"] [\y "0.06"] [\c "0.05"] [\p "0.05"] [\g "0.04"] [\k "0.04"] [\o "0.04"] [\f "0.02"] [\j "0.02"] [\n "0.02"] [\v "0.02"] [\x "0.02"] [\z "0.02"] [\d "0.01"] [\m "0.01"] [\q "0.01"] [\r "0.01"] [\b "0.00"] [\h "0.00"] [\i "0.00"] [\u "0.00"])
       '([\t "0.10"] [\p "0.09"] [\w "0.09"] [\e "0.06"] [\i "0.06"] [\m "0.06"] [\z "0.06"] [\b "0.05"] [\c "0.05"] [\u "0.05"] [\h "0.04"] [\s "0.04"] [\v "0.04"] [\a "0.03"] [\j "0.03"] [\k "0.03"] [\l "0.03"] [\o "0.03"] [\q "0.03"] [\d "0.01"] [\g "0.01"] [\n "0.01"] [\r "0.01"] [\x "0.01"] [\f "0.00"] [\y "0.00"])
       '([\w "0.10"] [\d "0.08"] [\j "0.08"] [\c "0.06"] [\e "0.06"] [\g "0.06"] [\p "0.06"] [\t "0.06"] [\f "0.05"] [\k "0.05"] [\n "0.05"] [\x "0.05"] [\z "0.05"] [\m "0.04"] [\o "0.04"] [\s "0.04"] [\y "0.03"] [\a "0.01"] [\h "0.01"] [\l "0.01"] [\u "0.01"] [\b "0.00"] [\i "0.00"] [\q "0.00"] [\r "0.00"] [\v "0.00"])
       '([\p "0.14"] [\v "0.09"] [\h "0.08"] [\i "0.08"] [\t "0.06"] [\b "0.05"] [\l "0.05"] [\m "0.05"] [\s "0.05"] [\x "0.05"] [\a "0.04"] [\d "0.04"] [\g "0.04"] [\j "0.04"] [\w "0.04"] [\n "0.03"] [\q "0.03"] [\z "0.03"] [\c "0.01"] [\e "0.01"] [\k "0.01"] [\u "0.01"] [\f "0.00"] [\o "0.00"] [\r "0.00"] [\y "0.00"])]
      (frequency-analysis/all-subfrequencies "rzsrppgeamjllagcpwxismxxcalecwygluetcaguepwwlznpclepcsgcpkgbacltcifstvntybwsepwutzkinweettwgqwjpnweefbwgazgvciebtvyalvyjlowhsmhdacdpcqrtobzttlwpznepnpacpqfspxwcomfiazgvciebtvyalvyjlowhhparstwsewlwplwkptgexmfiznudmwddymguepwutzkisqywwmntwxjdrzsbxqfvwifvfiytdwoxyoldsmjpnkgbatahsuwceascopwgyinpwzscvazthikhzuwituwhcmxtczwsewshlusotvyvciutepwjdvskjijapqywmcjzpkdpdayjtlwsxqkhttwspalgzgwgfakwzxhtceshyietonggsmjhsmopdxghepmbzckajiopclwsepwecmkxomfitidbplsaznxgpmvdxjqecmkxomfimijpnsgqlus" 7) =>
      ['([\t "0.16"] [\p "0.09"] [\e "0.07"] [\m "0.07"] [\g "0.06"] [\j "0.06"] [\w "0.06"] [\c "0.04"] [\n "0.04"] [\q "0.04"] [\a "0.03"] [\f "0.03"] [\h "0.03"] [\k "0.03"] [\l "0.03"] [\s "0.03"] [\x "0.03"] [\z "0.03"] [\i "0.01"] [\r "0.01"] [\u "0.01"] [\v "0.01"] [\y "0.01"] [\b "0.00"] [\d "0.00"] [\o "0.00"])
       '([\c "0.10"] [\w "0.10"] [\l "0.09"] [\e "0.07"] [\d "0.06"] [\f "0.06"] [\g "0.06"] [\a "0.04"] [\h "0.04"] [\k "0.04"] [\p "0.04"] [\y "0.04"] [\i "0.03"] [\s "0.03"] [\t "0.03"] [\x "0.03"] [\z "0.03"] [\j "0.01"] [\n "0.01"] [\o "0.01"] [\q "0.01"] [\r "0.01"] [\u "0.01"] [\v "0.01"] [\b "0.00"] [\m "0.00"])
       '([\w "0.10"] [\i "0.09"] [\m "0.09"] [\s "0.09"] [\p "0.07"] [\v "0.07"] [\h "0.06"] [\y "0.06"] [\l "0.04"] [\a "0.03"] [\c "0.03"] [\e "0.03"] [\g "0.03"] [\k "0.03"] [\n "0.03"] [\o "0.03"] [\t "0.03"] [\u "0.03"] [\z "0.03"] [\f "0.01"] [\r "0.01"] [\x "0.01"] [\b "0.00"] [\d "0.00"] [\j "0.00"] [\q "0.00"])
       '([\c "0.10"] [\w "0.10"] [\a "0.09"] [\b "0.06"] [\e "0.06"] [\g "0.06"] [\j "0.06"] [\m "0.06"] [\z "0.06"] [\t "0.04"] [\f "0.03"] [\h "0.03"] [\k "0.03"] [\n "0.03"] [\p "0.03"] [\s "0.03"] [\d "0.01"] [\i "0.01"] [\l "0.01"] [\o "0.01"] [\q "0.01"] [\r "0.01"] [\u "0.01"] [\v "0.01"] [\x "0.01"] [\y "0.01"])
       '([\s "0.12"] [\d "0.09"] [\i "0.09"] [\p "0.09"] [\a "0.07"] [\w "0.07"] [\z "0.07"] [\l "0.06"] [\j "0.04"] [\t "0.04"] [\u "0.04"] [\x "0.04"] [\c "0.03"] [\g "0.03"] [\k "0.03"] [\o "0.03"] [\b "0.01"] [\h "0.01"] [\n "0.01"] [\y "0.01"] [\e "0.00"] [\f "0.00"] [\m "0.00"] [\q "0.00"] [\r "0.00"] [\v "0.00"])
       '([\p "0.12"] [\w "0.09"] [\e "0.06"] [\g "0.06"] [\l "0.06"] [\s "0.06"] [\t "0.06"] [\i "0.04"] [\n "0.04"] [\u "0.04"] [\v "0.04"] [\x "0.04"] [\z "0.04"] [\b "0.03"] [\c "0.03"] [\d "0.03"] [\m "0.03"] [\q "0.03"] [\f "0.01"] [\h "0.01"] [\j "0.01"] [\k "0.01"] [\o "0.01"] [\r "0.01"] [\y "0.01"] [\a "0.00"])
       '([\o "0.09"] [\e "0.07"] [\w "0.07"] [\a "0.06"] [\c "0.06"] [\p "0.06"] [\s "0.06"] [\t "0.06"] [\x "0.06"] [\y "0.06"] [\b "0.04"] [\m "0.04"] [\v "0.04"] [\g "0.03"] [\i "0.03"] [\j "0.03"] [\q "0.03"] [\d "0.01"] [\f "0.01"] [\h "0.01"] [\k "0.01"] [\l "0.01"] [\n "0.01"] [\u "0.01"] [\z "0.01"] [\r "0.00"])]
      (frequency-analysis/all-subfrequencies "rzsrppgeamjllagcpwxismxxcalecwygluetcaguepwwlznpclepcsgcpkgbacltcifstvntybwsepwutzkinweettwgqwjpnweefbwgazgvciebtvyalvyjlowhsmhdacdpcqrtobzttlwpznepnpacpqfspxwcomfiazgvciebtvyalvyjlowhhparstwsewlwplwkptgexmfiznudmwddymguepwutzkisqywwmntwxjdrzsbxqfvwifvfiytdwoxyoldsmjpnkgbatahsuwceascopwgyinpwzscvazthikhzuwituwhcmxtczwsewshlusotvyvciutepwjdvskjijapqywmcjzpkdpdayjtlwsxqkhttwspalgzgwgfakwzxhtceshyietonggsmjhsmopdxghepmbzckajiopclwsepwecmkxomfitidbplsaznxgpmvdxjqecmkxomfimijpnsgqlus" 8) =>
      ['([\c "0.11"] [\e "0.11"] [\p "0.11"] [\t "0.08"] [\a "0.07"] [\l "0.07"] [\o "0.07"] [\y "0.05"] [\z "0.05"] [\d "0.03"] [\j "0.03"] [\m "0.03"] [\r "0.03"] [\s "0.03"] [\w "0.03"] [\f "0.02"] [\h "0.02"] [\n "0.02"] [\v "0.02"] [\x "0.02"] [\b "0.00"] [\g "0.00"] [\i "0.00"] [\k "0.00"] [\q "0.00"] [\u "0.00"])
       '([\m "0.16"] [\i "0.11"] [\a "0.10"] [\p "0.08"] [\w "0.08"] [\z "0.08"] [\n "0.05"] [\t "0.05"] [\u "0.05"] [\v "0.05"] [\b "0.03"] [\c "0.03"] [\l "0.03"] [\q "0.03"] [\e "0.02"] [\k "0.02"] [\o "0.02"] [\d "0.00"] [\f "0.00"] [\g "0.00"] [\h "0.00"] [\j "0.00"] [\r "0.00"] [\s "0.00"] [\x "0.00"] [\y "0.00"])
       '([\s "0.11"] [\w "0.11"] [\e "0.08"] [\f "0.08"] [\g "0.08"] [\j "0.08"] [\k "0.08"] [\y "0.07"] [\l "0.05"] [\o "0.05"] [\a "0.03"] [\n "0.03"] [\x "0.03"] [\z "0.03"] [\d "0.02"] [\m "0.02"] [\u "0.02"] [\v "0.02"] [\b "0.00"] [\c "0.00"] [\h "0.00"] [\i "0.00"] [\p "0.00"] [\q "0.00"] [\r "0.00"] [\t "0.00"])
       '([\p "0.13"] [\i "0.10"] [\h "0.08"] [\t "0.08"] [\b "0.07"] [\e "0.07"] [\a "0.05"] [\g "0.05"] [\j "0.05"] [\s "0.05"] [\v "0.05"] [\w "0.05"] [\d "0.03"] [\r "0.03"] [\x "0.03"] [\c "0.02"] [\l "0.02"] [\u "0.02"] [\z "0.02"] [\f "0.00"] [\k "0.00"] [\m "0.00"] [\n "0.00"] [\o "0.00"] [\q "0.00"] [\y "0.00"])
       '([\c "0.15"] [\t "0.12"] [\s "0.10"] [\l "0.08"] [\p "0.08"] [\n "0.07"] [\z "0.07"] [\x "0.05"] [\a "0.03"] [\d "0.03"] [\e "0.03"] [\f "0.03"] [\o "0.03"] [\w "0.03"] [\y "0.03"] [\h "0.02"] [\m "0.02"] [\q "0.02"] [\b "0.00"] [\g "0.00"] [\i "0.00"] [\j "0.00"] [\k "0.00"] [\r "0.00"] [\u "0.00"] [\v "0.00"])
       '([\i "0.10"] [\m "0.10"] [\p "0.08"] [\l "0.07"] [\q "0.07"] [\v "0.07"] [\w "0.07"] [\x "0.07"] [\z "0.07"] [\u "0.05"] [\a "0.03"] [\c "0.03"] [\k "0.03"] [\o "0.03"] [\s "0.03"] [\t "0.03"] [\b "0.02"] [\g "0.02"] [\j "0.02"] [\n "0.02"] [\d "0.00"] [\e "0.00"] [\f "0.00"] [\h "0.00"] [\r "0.00"] [\y "0.00"])
       '([\w "0.27"] [\g "0.13"] [\y "0.10"] [\d "0.05"] [\e "0.05"] [\f "0.05"] [\j "0.05"] [\k "0.05"] [\s "0.05"] [\h "0.03"] [\l "0.03"] [\n "0.03"] [\x "0.03"] [\a "0.02"] [\q "0.02"] [\r "0.02"] [\u "0.02"] [\b "0.00"] [\c "0.00"] [\i "0.00"] [\m "0.00"] [\o "0.00"] [\p "0.00"] [\t "0.00"] [\v "0.00"] [\z "0.00"])
       '([\t "0.12"] [\c "0.10"] [\g "0.08"] [\h "0.08"] [\s "0.08"] [\d "0.07"] [\p "0.07"] [\b "0.05"] [\e "0.05"] [\u "0.05"] [\a "0.03"] [\i "0.03"] [\k "0.03"] [\v "0.03"] [\w "0.03"] [\x "0.03"] [\j "0.02"] [\o "0.02"] [\q "0.02"] [\f "0.00"] [\l "0.00"] [\m "0.00"] [\n "0.00"] [\r "0.00"] [\y "0.00"] [\z "0.00"])])

(fact "subfrequency matcher"
      (frequency-analysis/subfrequency-matcher "rzsrppgeamjllagcpwxismxxcalecwygluetcaguepwwlznpclepcsgcpkgbacltcifstvntybwsepwutzkinweettwgqwjpnweefbwgazgvciebtvyalvyjlowhsmhdacdpcqrtobzttlwpznepnpacpqfspxwcomfiazgvciebtvyalvyjlowhhparstwsewlwplwkptgexmfiznudmwddymguepwutzkisqywwmntwxjdrzsbxqfvwifvfiytdwoxyoldsmjpnkgbatahsuwceascopwgyinpwzscvazthikhzuwituwhcmxtczwsewshlusotvyvciutepwjdvskjijapqywmcjzpkdpdayjtlwsxqkhttwspalgzgwgfakwzxhtceshyietonggsmjhsmopdxghepmbzckajiopclwsepwecmkxomfitidbplsaznxgpmvdxjqecmkxomfimijpnsgqlus" 5) =>
      [[\a 5] [\h 3] [\g 2]])

(fact "subfrequency matcher"
      (frequency-analysis/all-subfrequency-matcher "rzsrppgeamjllagcpwxismxxcalecwygluetcaguepwwlznpclepcsgcpkgbacltcifstvntybwsepwutzkinweettwgqwjpnweefbwgazgvciebtvyalvyjlowhsmhdacdpcqrtobzttlwpznepnpacpqfspxwcomfiazgvciebtvyalvyjlowhhparstwsewlwplwkptgexmfiznudmwddymguepwutzkisqywwmntwxjdrzsbxqfvwifvfiytdwoxyoldsmjpnkgbatahsuwceascopwgyinpwzscvazthikhzuwituwhcmxtczwsewshlusotvyvciutepwjdvskjijapqywmcjzpkdpdayjtlwsxqkhttwspalgzgwgfakwzxhtceshyietonggsmjhsmopdxghepmbzckajiopclwsepwecmkxomfitidbplsaznxgpmvdxjqecmkxomfimijpnsgqlus" 4) =>
      ['([\l 3] [\b 2] [\c 2])
       '([\i 4] [\p 3] [\t 3])
       '([\s 3] [\a 2] [\c 2])
       '([\a 3] [\p 3] [\s 2])]
      (frequency-analysis/all-subfrequency-matcher "rzsrppgeamjllagcpwxismxxcalecwygluetcaguepwwlznpclepcsgcpkgbacltcifstvntybwsepwutzkinweettwgqwjpnweefbwgazgvciebtvyalvyjlowhsmhdacdpcqrtobzttlwpznepnpacpqfspxwcomfiazgvciebtvyalvyjlowhhparstwsewlwplwkptgexmfiznudmwddymguepwutzkisqywwmntwxjdrzsbxqfvwifvfiytdwoxyoldsmjpnkgbatahsuwceascopwgyinpwzscvazthikhzuwituwhcmxtczwsewshlusotvyvciutepwjdvskjijapqywmcjzpkdpdayjtlwsxqkhttwspalgzgwgfakwzxhtceshyietonggsmjhsmopdxghepmbzckajiopclwsepwecmkxomfitidbplsaznxgpmvdxjqecmkxomfimijpnsgqlus" 8) =>
      ['([\a 4] [\g 3] [\y 3])
       '([\i 4] [\m 3] [\a 2])
       '([\d 2] [\h 2] [\l 2])
       '([\f 3] [\p 3] [\k 2])
       '([\a 3] [\c 2] [\h 2])
       '([\i 5] [\a 2] [\e 2])
       '([\d 3] [\a 2] [\e 2])
       '([\q 4] [\a 2] [\g 2])])
